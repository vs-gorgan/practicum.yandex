#  Исследование надежности заемщиков

## 1 Откройте таблицу и изучите общую информацию о данных

**Задание 1. Импортируйте библиотеку pandas. Считайте данные из csv-файла в датафрейм и сохраните в переменную `data`. Путь к файлу:**

`/datasets/data.csv`
```
import pandas as pd # импортируйте библиотеку pandas
```
```
data = pd.read_csv('/datasets/data.csv') # прочитайте csv-файл
```
**Задание 2. Выведите первые 20 строчек датафрейма `data` на экран.**
```
data.head(20)
```
| children | days_employed |     dob_years | education |        education_id | family_status | family_status_id | gender | income_type |      debt | total_income | purpose |                  total_income_category | purpose_category |                          |
|---------:|--------------:|--------------:|----------:|--------------------:|--------------:|-----------------:|-------:|------------:|----------:|-------------:|--------:|---------------------------------------:|-----------------:|--------------------------|
|     0    | 1             | 8437.673028   | 42        | высшее              | 0             | женат / замужем  | 0      | F           | сотрудник | 0            | 253875  | покупка жилья                          | B                | операции с недвижимостью |
|     1    | 1             | 4024.803754   | 36        | среднее             | 1             | женат / замужем  | 0      | F           | сотрудник | 0            | 112080  | приобретение автомобиля                | C                | операции с автомобилем   |
|     2    | 0             | 5623.422610   | 33        | среднее             | 1             | женат / замужем  | 0      | M           | сотрудник | 0            | 145885  | покупка жилья                          | C                | операции с недвижимостью |
|     3    | 3             | 4124.747207   | 32        | среднее             | 1             | женат / замужем  | 0      | M           | сотрудник | 0            | 267628  | дополнительное образование             | B                | получение образования    |
|     4    | 0             | 340266.072047 | 53        | среднее             | 1             | гражданский брак | 1      | F           | пенсионер | 0            | 158616  | сыграть свадьбу                        | C                | проведение свадьбы       |
|     5    | 0             | 926.185831    | 27        | высшее              | 0             | гражданский брак | 1      | M           | компаньон | 0            | 255763  | покупка жилья                          | B                | операции с недвижимостью |
|     6    | 0             | 2879.202052   | 43        | высшее              | 0             | женат / замужем  | 0      | F           | компаньон | 0            | 240525  | операции с жильем                      | B                | операции с недвижимостью |
|     7    | 0             | 152.779569    | 50        | среднее             | 1             | женат / замужем  | 0      | M           | сотрудник | 0            | 135823  | образование                            | C                | получение образования    |
|     8    | 2             | 6929.865299   | 35        | высшее              | 0             | гражданский брак | 1      | F           | сотрудник | 0            | 95856   | на проведение свадьбы                  | C                | проведение свадьбы       |
|     9    | 0             | 2188.756445   | 41        | среднее             | 1             | женат / замужем  | 0      | M           | сотрудник | 0            | 144425  | покупка жилья для семьи                | C                | операции с недвижимостью |
|    10    | 2             | 4171.483647   | 36        | высшее              | 0             | женат / замужем  | 0      | M           | компаньон | 0            | 113943  | покупка недвижимости                   | C                | операции с недвижимостью |
|    11    | 0             | 792.701887    | 40        | среднее             | 1             | женат / замужем  | 0      | F           | сотрудник | 0            | 77069   | покупка коммерческой недвижимости      | C                | операции с недвижимостью |
|    12    | 0             | 365286.622650 | 65        | среднее             | 1             | гражданский брак | 1      | M           | пенсионер | 0            | 118514  | сыграть свадьбу                        | C                | проведение свадьбы       |
|    13    | 0             | 1846.641941   | 54        | неоконченное высшее | 2             | женат / замужем  | 0      | F           | сотрудник | 0            | 130458  | приобретение автомобиля                | C                | операции с автомобилем   |
|    14    | 0             | 1844.956182   | 56        | высшее              | 0             | гражданский брак | 1      | F           | компаньон | 1            | 165127  | покупка жилой недвижимости             | C                | операции с недвижимостью |
|    15    | 1             | 972.364419    | 26        | среднее             | 1             | женат / замужем  | 0      | F           | сотрудник | 0            | 116820  | строительство собственной недвижимости | C                | операции с недвижимостью |
|    16    | 0             | 1719.934226   | 35        | среднее             | 1             | женат / замужем  | 0      | F           | сотрудник | 0            | 289202  | недвижимость                           | B                | операции с недвижимостью |
|    17    | 0             | 2369.999720   | 33        | высшее              | 0             | гражданский брак | 1      | M           | сотрудник | 0            | 90410   | строительство недвижимости             | C                | операции с недвижимостью |
|    18    | 0             | 400281.136913 | 53        | среднее             | 1             | вдовец / вдова   | 2      | F           | пенсионер | 0            | 56823   | на покупку подержанного автомобиля     | C                | операции с автомобилем   |
|    19    | 0             | 10038.818549  | 48        | среднее             | 1             | в разводе        | 3      | F           | сотрудник | 0            | 242831  | на покупку своего автомобиля           | B                | операции с автомобилем   |

**Задание 3. Выведите основную информацию о датафрейме с помощью метода `info()`.**
```
data.info()
```
```
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 21525 entries, 0 to 21524
Data columns (total 12 columns):
 #   Column            Non-Null Count  Dtype  
---  ------            --------------  -----  
 0   children          21525 non-null  int64  
 1   days_employed     19351 non-null  float64
 2   dob_years         21525 non-null  int64  
 3   education         21525 non-null  object 
 4   education_id      21525 non-null  int64  
 5   family_status     21525 non-null  object 
 6   family_status_id  21525 non-null  int64  
 7   gender            21525 non-null  object 
 8   income_type       21525 non-null  object 
 9   debt              21525 non-null  int64  
 10  total_income      19351 non-null  float64
 11  purpose           21525 non-null  object 
dtypes: float64(2), int64(5), object(5)
memory usage: 2.0+ MB
```

## 2 Предобработка данных

### 2.1 Удаление пропусков

**Задание 4. Выведите количество пропущенных значений для каждого столбца. Используйте комбинацию двух методов.**
```
data.isna().sum()
```
```
children               0
days_employed       2174
dob_years              0
education              0
education_id           0
family_status          0
family_status_id       0
gender                 0
income_type            0
debt                   0
total_income        2174
purpose                0
dtype: int64
```

**Задание 5. В двух столбцах есть пропущенные значения. Один из них — `days_employed`. Пропуски в этом столбце вы обработаете на следующем этапе. Другой столбец с пропущенными значениями — `total_income` — хранит данные о доходах. На сумму дохода сильнее всего влияет тип занятости, поэтому заполнить пропуски в этом столбце нужно медианным значением по каждому типу из столбца `income_type`. Например, у человека с типом занятости `сотрудник` пропуск в столбце `total_income` должен быть заполнен медианным доходом среди всех записей с тем же типом.**
```
data['total_income'] = data['total_income'].fillna(data.groupby('income_type')['total_income'].transform('median'))
```

### 2.2 Обработка аномальных значений

**Задание 6. В данных могут встречаться артефакты (аномалии) — значения, которые не отражают действительность и появились по какой-то ошибке. Таким артефактом будет отрицательное количество дней трудового стажа в столбце `days_employed`. Для реальных данных это нормально. Обработайте значения в этом столбце: замените все отрицательные значения положительными с помощью метода `abs()`.**
```
data['days_employed'] = data['days_employed'].abs()
```
**Задание 7. Для каждого типа занятости выведите медианное значение трудового стажа `days_employed` в днях.**
```
data.groupby('income_type')['days_employed'].median()
```
```
income_type
безработный        366413.652744
в декрете            3296.759962
госслужащий          2689.368353
компаньон            1547.382223
пенсионер          365213.306266
предприниматель       520.848083
сотрудник            1574.202821
студент               578.751554
Name: days_employed, dtype: float64
```

У двух типов (безработные и пенсионеры) получатся аномально большие значения. Исправить такие значения сложно, поэтому оставьте их как есть. Тем более этот столбец не понадобится вам для исследования.

**Задание 8. Выведите перечень уникальных значений столбца `children`.**
```
data['children'].unique()
```
```
array([ 1,  0,  3,  2, -1,  4, 20,  5])
```
**Задание 9. В столбце `children` есть два аномальных значения. Удалите строки, в которых встречаются такие аномальные значения из датафрейма `data`.**
```
data = (data.loc[(data['children'] != -1) & (data['children'] != 20)]) 
data['children'].unique()
```
**Задание 10. Ещё раз выведите перечень уникальных значений столбца `children`, чтобы убедиться, что артефакты удалены.**
 ```
array([1, 0, 3, 2, 4, 5])
```
### 2.3 Удаление пропусков (продолжение)

**Задание 11. Заполните пропуски в столбце `days_employed` медианными значениями по каждому типу занятости `income_type`.**
```
data['days_employed'] = data['days_employed'].fillna(data.groupby('income_type')['days_employed'].transform('median'))
```
**Задание 12. Убедитесь, что все пропуски заполнены. Проверьте себя и ещё раз выведите количество пропущенных значений для каждого столбца с помощью двух методов.**
```
data.isna().sum()
```
```
children            0
days_employed       0
dob_years           0
education           0
education_id        0
family_status       0
family_status_id    0
gender              0
income_type         0
debt                0
total_income        0
purpose             0
dtype: int64
```
### 2.4 Изменение типов данных

**Задание 13. Замените вещественный тип данных в столбце `total_income` на целочисленный с помощью метода `astype()`.**
```
data['total_income'] = data['total_income'].astype(int)
```
### 2.5 Обработка дубликатов

**Задание 14. Выведите на экран количество строк-дубликатов в данных. Если такие строки присутствуют, удалите их.**
```
data.duplicated().sum() # посчитаем дубликаты
```
```
54
```
```
data = data.drop_duplicates() # удалим дубликаты
```
**Задание 15. Обработайте неявные дубликаты в столбце `education`. В этом столбце есть одни и те же значения, но записанные по-разному: с использованием заглавных и строчных букв. Приведите их к нижнему регистру. Проверьте остальные столбцы.**
```
data['education'] = data['education'].str.lower()
data['education'].value_counts()
```
```
среднее                15091
высшее                  5228
неоконченное высшее      741
начальное                282
ученая степень             6
Name: education, dtype: int64
```
### 2.6 Категоризация данных

