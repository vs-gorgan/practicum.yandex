# Исследование объявлений о продаже квартир

В распоряжении данные сервиса Яндекс Недвижимость — архив объявлений за несколько лет о продаже квартир в Санкт-Петербурге и соседних населённых пунктах.

Задача — выполнить предобработку данных и изучить их, чтобы найти интересные особенности и зависимости, которые существуют на рынке недвижимости.

О каждой квартире в базе содержится два типа данных: добавленные пользователем и картографические. Например, к первому типу относятся площадь квартиры, её этаж и количество балконов, ко второму — расстояния до центра города, аэропорта и ближайшего парка. 

### 1. Откройте файл с данными и изучите общую информацию. 
```
import pandas as pd
import matplotlib.pyplot as plt 
import seaborn as sns
```
```
df = pd.read_csv('/datasets/real_estate_data.csv',  sep='\t')
```
выведем первые 5 строк
```
df.head()
```
|   | total_images | last_price | total_area | first_day_exposition | rooms | ceiling_height | floors_total | living_area | floor | is_apartment | ... | kitchen_area | balcony |   locality_name | airports_nearest | cityCenters_nearest | parks_around3000 | parks_nearest | ponds_around3000 | ponds_nearest | days_exposition |
|--:|-------------:|-----------:|-----------:|---------------------:|------:|---------------:|-------------:|------------:|------:|-------------:|----:|-------------:|--------:|----------------:|-----------------:|--------------------:|-----------------:|--------------:|-----------------:|--------------:|----------------:|
| 0 | 20           | 13000000.0 | 108.0      | 2019-03-07T00:00:00  | 3     | 2.70           | 16.0         | 51.0        | 8     | NaN          | ... | 25.0         | NaN     | Санкт-Петербург | 18863.0          | 16028.0             | 1.0              | 482.0         | 2.0              | 755.0         | NaN             |
| 1 | 7            | 3350000.0  | 40.4       | 2018-12-04T00:00:00  | 1     | NaN            | 11.0         | 18.6        | 1     | NaN          | ... | 11.0         | 2.0     | посёлок Шушары  | 12817.0          | 18603.0             | 0.0              | NaN           | 0.0              | NaN           | 81.0            |
| 2 | 10           | 5196000.0  | 56.0       | 2015-08-20T00:00:00  | 2     | NaN            | 5.0          | 34.3        | 4     | NaN          | ... | 8.3          | 0.0     | Санкт-Петербург | 21741.0          | 13933.0             | 1.0              | 90.0          | 2.0              | 574.0         | 558.0           |
| 3 | 0            | 64900000.0 | 159.0      | 2015-07-24T00:00:00  | 3     | NaN            | 14.0         | NaN         | 9     | NaN          | ... | NaN          | 0.0     | Санкт-Петербург | 28098.0          | 6800.0              | 2.0              | 84.0          | 3.0              | 234.0         | 424.0           |
| 4 | 2            | 10000000.0 | 100.0      | 2018-06-19T00:00:00  | 2     | 3.03           | 14.0         | 32.0        | 13    | NaN          | ... | 41.0         | NaN     | Санкт-Петербург | 31856.0          | 8098.0              | 2.0              | 112.0         | 1.0              | 48.0          | 121.0           |

изучим общую информацию о датафрейме
```
df.info()
```
```
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 23699 entries, 0 to 23698
Data columns (total 22 columns):
 #   Column                Non-Null Count  Dtype  
---  ------                --------------  -----  
 0   total_images          23699 non-null  int64  
 1   last_price            23699 non-null  float64
 2   total_area            23699 non-null  float64
 3   first_day_exposition  23699 non-null  object 
 4   rooms                 23699 non-null  int64  
 5   ceiling_height        14504 non-null  float64
 6   floors_total          23613 non-null  float64
 7   living_area           21796 non-null  float64
 8   floor                 23699 non-null  int64  
 9   is_apartment          2775 non-null   object 
 10  studio                23699 non-null  bool   
 11  open_plan             23699 non-null  bool   
 12  kitchen_area          21421 non-null  float64
 13  balcony               12180 non-null  float64
 14  locality_name         23650 non-null  object 
 15  airports_nearest      18157 non-null  float64
 16  cityCenters_nearest   18180 non-null  float64
 17  parks_around3000      18181 non-null  float64
 18  parks_nearest         8079 non-null   float64
 19  ponds_around3000      18181 non-null  float64
 20  ponds_nearest         9110 non-null   float64
 21  days_exposition       20518 non-null  float64
dtypes: bool(2), float64(14), int64(3), object(3)
memory usage: 3.7+ MB
```
Построим общую гистограмму для всех столбцов таблицы.
```
df.hist(figsize=(15, 20))
```
![cover](https://github.com/vs-gorgan/practicum.yandex/blob/main/03_spb_real_estate/hist.png)

### 2. Предобработка данных

**2.1. Удаление пропусков**

Определим число прокусков для каждого столбца. Создадим переменную `skip`
```
skip = pd.DataFrame(df.isna().sum()) \
    .rename(columns={0: 'before'})
skip
```
|                      | before |
|---------------------:|-------:|
|     total_images     | 0      |
|      last_price      | 0      |
|      total_area      | 0      |
| first_day_exposition | 0      |
|         rooms        | 0      |
|    ceiling_height    | 9195   |
|     floors_total     | 86     |
|      living_area     | 1903   |
|         floor        | 0      |
|     is_apartment     | 20924  |
|        studio        | 0      |
|       open_plan      | 0      |
|     kitchen_area     | 2278   |
|        balcony       | 11519  |
|     locality_name    | 49     |
|   airports_nearest   | 5542   |
|  cityCenters_nearest | 5519   |
|   parks_around3000   | 5518   |
|     parks_nearest    | 15620  |
|   ponds_around3000   | 5518   |
|     ponds_nearest    | 14589  |
|    days_exposition   | 3181   |

Пропуски данных в:

`ceiling_height` — высота потолков (м)
Сгруппируем данные по этажам. Заполним медианным значением.

`floors_total` — всего этажей в доме

`living_area` — жилая площадь в квадратных метрах (м²)

`is_apartment` — апартаменты (булев тип)
Всего 23,6 тыс строк. Данные отсутствуют в 21 тыс строк.
Вкорее всего если ответ отрицательный, т.е. не аппартаменты - значение отсутствует.
Установм False для пропусков.

`kitchen_area` — площадь кухни в квадратных метрах (м²)

`balcony` — число балконов
При заполнении пропусков применим аналогочный с апартаментами метод.
Пропуски заменим на ноль.

`locality_name` — название населённого пункта

`airports_nearest` — расстояние до ближайшего аэропорта в метрах (м)

`cityCenters_nearest` — расстояние до центра города (м)

`parks_around3000` — число парков в радиусе 3 км

`parks_nearest` — расстояние до ближайшего парка (м)

`ponds_around3000` — число водоёмов в радиусе 3 км

`ponds_nearest` — расстояние до ближайшего водоёма (м)

`days_exposition` — сколько дней было размещено объявление (от публикации до снятия)

Начнём заполнение пропусков в колонке с количеством балконов. Скорее всего в квартирах с пропущенными значениями нет балконов
```
# заменим пропуски данных в колонке с числом балконов на ноль
df['balcony'] = df['balcony'].fillna(0)

# для столбца balcony установим тип float. 
df['balcony'] = pd.to_numeric(df['balcony'])
```
```
# число балконов всегда целое число. Установим тип int
df['balcony'] = df['balcony'].astype(int)
df['balcony'].value_counts()
```
```
0    15277
1     4195
2     3659
5      304
4      183
3       81
Name: balcony, dtype: int64
```
Колонка `ceiling_height` имеет 9195 пропусков. Установим для неё корректный тип данных. В данном случае нам нужны вещественные числа.
```
df['ceiling_height'] = pd.to_numeric(df['ceiling_height'], errors='coerce') # переведём значение столбца в тип float
ceiling_height = df['ceiling_height'] # извлечем столбец с высотой потолков в отдельный список
ceiling_height = ceiling_height.sort_values() # примените к нему метод сортировки
ceiling_height_unique = ceiling_height.unique() # выведем уникальные значения
ceiling_height_unique
```
```
array([  1.  ,   1.2 ,   1.75,   2.  ,   2.2 ,   2.25,   2.3 ,   2.34,
         2.4 ,   2.45,   2.46,   2.47,   2.48,   2.49,   2.5 ,   2.51,
         2.52,   2.53,   2.54,   2.55,   2.56,   2.57,   2.58,   2.59,
         2.6 ,   2.61,   2.62,   2.63,   2.64,   2.65,   2.66,   2.67,
         2.68,   2.69,   2.7 ,   2.71,   2.72,   2.73,   2.74,   2.75,
         2.76,   2.77,   2.78,   2.79,   2.8 ,   2.81,   2.82,   2.83,
         2.84,   2.85,   2.86,   2.87,   2.88,   2.89,   2.9 ,   2.91,
         2.92,   2.93,   2.94,   2.95,   2.96,   2.97,   2.98,   2.99,
         3.  ,   3.01,   3.02,   3.03,   3.04,   3.05,   3.06,   3.07,
         3.08,   3.09,   3.1 ,   3.11,   3.12,   3.13,   3.14,   3.15,
         3.16,   3.17,   3.18,   3.2 ,   3.21,   3.22,   3.23,   3.24,
         3.25,   3.26,   3.27,   3.28,   3.29,   3.3 ,   3.31,   3.32,
         3.33,   3.34,   3.35,   3.36,   3.37,   3.38,   3.39,   3.4 ,
         3.42,   3.43,   3.44,   3.45,   3.46,   3.47,   3.48,   3.49,
         3.5 ,   3.51,   3.52,   3.53,   3.54,   3.55,   3.56,   3.57,
         3.58,   3.59,   3.6 ,   3.62,   3.63,   3.65,   3.66,   3.67,
         3.68,   3.69,   3.7 ,   3.75,   3.76,   3.78,   3.8 ,   3.82,
         3.83,   3.84,   3.85,   3.86,   3.87,   3.88,   3.9 ,   3.93,
         3.95,   3.98,   4.  ,   4.06,   4.1 ,   4.14,   4.15,   4.19,
         4.2 ,   4.25,   4.3 ,   4.37,   4.4 ,   4.45,   4.5 ,   4.65,
         4.7 ,   4.8 ,   4.9 ,   5.  ,   5.2 ,   5.3 ,   5.5 ,   5.6 ,
         5.8 ,   6.  ,   8.  ,   8.3 ,  10.3 ,  14.  ,  20.  ,  22.6 ,
        24.  ,  25.  ,  26.  ,  27.  ,  27.5 ,  32.  , 100.  ,    nan])
```
