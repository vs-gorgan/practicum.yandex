# Описание проекта

Для увеличения выручки в крупном интернет-магазина аналитик совместно с отделом маркетинга подготовили список гипотез.

**Исходные данные:**

- Гипотезы
- Данные о заказах
- данные о посетителях

**Цель** Приоритизировать гипотезы, запустить A/B-тест и проанализировать результаты. 

```
# импортируем библиотеку обработки и анализа структурированных данных
import pandas as pd
pd.set_option('display.max_colwidth', None)

# импортируем библиотеку для визуализации данных двумерной и трёхмерной графикой
import matplotlib.pyplot as plt

# импортируем библиотеку математических вычислений
import numpy as np

# импортируем модуль для работы с датой и временем
import datetime as dt

# импортируем статистические функции
import scipy.stats as stats
```
```
hypothesis = pd.read_csv('/datasets/hypothesis.csv')
orders = pd.read_csv('/datasets/orders.csv', parse_dates=['date'])
visitors = pd.read_csv('/datasets/visitors.csv', parse_dates=['date'])
```
### 0.1 Выполним предобработку данных

Файл **hypothesis**
```
hypothesis.info()
```
```
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 9 entries, 0 to 8
Data columns (total 5 columns):
 #   Column      Non-Null Count  Dtype 
---  ------      --------------  ----- 
 0   Hypothesis  9 non-null      object
 1   Reach       9 non-null      int64 
 2   Impact      9 non-null      int64 
 3   Confidence  9 non-null      int64 
 4   Efforts     9 non-null      int64 
dtypes: int64(4), object(1)
memory usage: 488.0+ bytes
```
```
# Приведём название колонок к нижнему регистру
hypothesis.columns = hypothesis.columns.str.lower()
```
```
hypothesis
```
|   |                                                                                                   hypothesis | reach | impact | confidence | efforts |
|--:|-------------------------------------------------------------------------------------------------------------:|------:|-------:|-----------:|--------:|
| 0 | Добавить два новых канала привлечения трафика, что позволит привлекать на 30% больше пользователей           | 3     | 10     | 8          | 6       |
| 1 | Запустить собственную службу доставки, что сократит срок доставки заказов                                    | 2     | 5      | 4          | 10      |
| 2 | Добавить блоки рекомендаций товаров на сайт интернет магазина, чтобы повысить конверсию и средний чек заказа | 8     | 3      | 7          | 3       |
| 3 | Изменить структура категорий, что увеличит конверсию, т.к. пользователи быстрее найдут нужный товар          | 8     | 3      | 3          | 8       |
| 4 | Изменить цвет фона главной страницы, чтобы увеличить вовлеченность пользователей                             | 3     | 1      | 1          | 1       |
| 5 | Добавить страницу отзывов клиентов о магазине, что позволит увеличить количество заказов                     | 3     | 2      | 2          | 3       |
| 6 | Показать на главной странице баннеры с актуальными акциями и распродажами, чтобы увеличить конверсию         | 5     | 3      | 8          | 3       |
| 7 | Добавить форму подписки на все основные страницы, чтобы собрать базу клиентов для email-рассылок             | 10    | 7      | 8          | 5       |
| 8 | Запустить акцию, дающую скидку на товар в день рождения                                                      | 1     | 9      | 9          | 5       |

Типы данных установлены корректно. Дубликатов нет   
Содержание таблицы:
- `Hypothesis` — краткое описание гипотезы;
- `Reach` — охват пользователей по 10-балльной шкале;
- `Impact` — влияние на пользователей по 10-балльной шкале;
- `Confidence` — уверенность в гипотезе по 10-балльной шкале;
- `Efforts` — затраты ресурсов на проверку гипотезы по 10-балльной шкале. Чем больше значение Efforts, тем дороже проверка гипотезы.

Файл **orders**
```
orders.info()
```
```
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 1197 entries, 0 to 1196
Data columns (total 5 columns):
 #   Column         Non-Null Count  Dtype         
---  ------         --------------  -----         
 0   transactionId  1197 non-null   int64         
 1   visitorId      1197 non-null   int64         
 2   date           1197 non-null   datetime64[ns]
 3   revenue        1197 non-null   int64         
 4   group          1197 non-null   object        
dtypes: datetime64[ns](1), int64(3), object(1)
memory usage: 46.9+ KB
```
```
# Приведём название колонок к змеиному регистру
orders.columns = ['transaction_id', 'visitor_id', 'date', 'revenue', 'group']
```
```
print('Полных дубликатов =', orders.duplicated().sum())
```
Полных дубликатов = 0
```
orders.head()
```
|   | transaction_id | visitor_id |       date | revenue | group |
|--:|---------------:|-----------:|-----------:|--------:|------:|
| 0 | 3667963787     | 3312258926 | 2019-08-15 | 1650    | B     |
| 1 | 2804400009     | 3642806036 | 2019-08-15 | 730     | B     |
| 2 | 2961555356     | 4069496402 | 2019-08-15 | 400     | A     |
| 3 | 3797467345     | 1196621759 | 2019-08-15 | 9759    | B     |
| 4 | 2282983706     | 2322279887 | 2019-08-15 | 2308    | B     |

Для колонок установили нужный тип данных. Дубликатов нет   
Содержание таблицы:
- `transaction_id` — идентификатор заказа;
- `visitor_id` — идентификатор пользователя, совершившего заказ;
- `date` — дата, когда был совершён заказ;
- `revenue` — выручка заказа;
- `group` — группа A/B-теста, в которую попал заказ.

Файл **visitors**
```
visitors.info()
```
```
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 62 entries, 0 to 61
Data columns (total 3 columns):
 #   Column    Non-Null Count  Dtype         
---  ------    --------------  -----         
 0   date      62 non-null     datetime64[ns]
 1   group     62 non-null     object        
 2   visitors  62 non-null     int64         
dtypes: datetime64[ns](1), int64(1), object(1)
memory usage: 1.6+ KB
```
```
print('Полных дубликатов =', visitors.duplicated().sum())
```
Полных дубликатов = 0
```
visitors.head()
```
|   |       date | group | visitors |
|--:|-----------:|------:|---------:|
| 0 | 2019-08-01 | A     | 719      |
| 1 | 2019-08-02 | A     | 619      |
| 2 | 2019-08-03 | A     | 507      |
| 3 | 2019-08-04 | A     | 717      |
| 4 | 2019-08-05 | A     | 756      |

Наименование столбцов корретно. Тип данны заменён. Дубликатов нет.   
Содержание таблицы:
- `date` — дата;
- `group` — группа A/B-теста;
- `visitors` — количество пользователей в указанную дату в указанной группе A/B-теста

Выполним дополнительные исследования. 
```
print('Количество групп в АВ-тесте в датафрейме orders -', len(orders.group.unique()))
print('Количество групп в АВ-тесте в датафрейме visitors -', len(visitors.group.unique()))
print()
print('min дата журнала заказов', orders['date'].min())
print('max дата журнала заказов', orders['date'].max())
print()
print('min дата журнала визитов', visitors['date'].min())
print('max дата журнала визитов', visitors['date'].max())
print()
print('Количество пользователей в группе А -', orders.query('group=="A"')['visitor_id'].nunique())
print('Количество пользователей в группе B -', orders.query('group=="B"')['visitor_id'].nunique())
print()
print('Кол-во посещений группы А', visitors.query('group=="A"')['visitors'].sum())
print('Кол-во посещений группы B', visitors.query('group=="B"')['visitors'].sum())
```
Количество групп в АВ-тесте в датафрейме orders - 2
Количество групп в АВ-тесте в датафрейме visitors - 2

min дата журнала заказов 2019-08-01 00:00:00
max дата журнала заказов 2019-08-31 00:00:00

min дата журнала визитов 2019-08-01 00:00:00
max дата журнала визитов 2019-08-31 00:00:00

Количество пользователей в группе А - 503
Количество пользователей в группе B - 586

Кол-во посещений группы А 18736
Кол-во посещений группы B 18916
```
groups = (
        orders.groupby('visitor_id') \
        .agg({'group': 'nunique'}) \
        .reset_index() \
        .query('group != 1')
)
print('Количество пользователей попавших в обе группы -', len(groups))
```
Количество пользователей попавших в обе группы - 58

### 1 Приоритизация гипотез.

В файле `/datasets/hypothesis.csv` 9 гипотез по увеличению выручки интернет-магазина с указанными параметрами `Reach`, `Impact`, `Confidence`, `Effort`.

**1.1. Примените фреймворк ICE для приоритизации гипотез. Отсортируйте их по убыванию приоритета.**

Фреймворк ICE отражает взияние гипотезы

<br>

$$ICE = \frac{Impact * Confidence}{Efforts}$$

$$RICE = \frac{Rearch * Impact * Confidence}{Efforts}$$
</div>

```
# Вычислим произведение влияние на пользователей и уверенность в гипотезе.
# Результат разделим на затраты ресурсов на проверку гипотезы
hypothesis['ICE'] = (hypothesis['impact'] * hypothesis['confidence']) / hypothesis['efforts']

print(hypothesis[['hypothesis', 'ICE']].sort_values(by='ICE', ascending=False))
```
```
 hypothesis  \
8                                                       Запустить акцию, дающую скидку на товар в день рождения   
0            Добавить два новых канала привлечения трафика, что позволит привлекать на 30% больше пользователей   
7              Добавить форму подписки на все основные страницы, чтобы собрать базу клиентов для email-рассылок   
6          Показать на главной странице баннеры с актуальными акциями и распродажами, чтобы увеличить конверсию   
2  Добавить блоки рекомендаций товаров на сайт интернет магазина, чтобы повысить конверсию и средний чек заказа   
1                                     Запустить собственную службу доставки, что сократит срок доставки заказов   
5                      Добавить страницу отзывов клиентов о магазине, что позволит увеличить количество заказов   
3           Изменить структура категорий, что увеличит конверсию, т.к. пользователи быстрее найдут нужный товар   
4                              Изменить цвет фона главной страницы, чтобы увеличить вовлеченность пользователей   

         ICE  
8  16.200000  
0  13.333333  
7  11.200000  
6   8.000000  
2   7.000000  
1   2.000000  
5   1.333333  
3   1.125000  
4   1.000000  
```
Наиболее перспективные гипотезы по ICE:
- Запустить акцию, дающую скидку на товар в день рождения
- Добавить два новых канала привлечения трафика, что позволит привлекать на 30% больше пользователей
- Добавить форму подписки на все основные страницы, чтобы собрать базу клиентов для email-рассылок


**1.2  Примените фреймворк RICE для приоритизации гипотез. Отсортируйте их по убыванию приоритета.**

```
# Добавим в числитель охват пользователей
hypothesis['RICE'] = (hypothesis['reach'] * hypothesis['impact'] * hypothesis['confidence']) / hypothesis['efforts']
print(hypothesis[['hypothesis', 'RICE']].sort_values(by='RICE', ascending=False))
```
```
                                                                                                     hypothesis  \
7              Добавить форму подписки на все основные страницы, чтобы собрать базу клиентов для email-рассылок   
2  Добавить блоки рекомендаций товаров на сайт интернет магазина, чтобы повысить конверсию и средний чек заказа   
0            Добавить два новых канала привлечения трафика, что позволит привлекать на 30% больше пользователей   
6          Показать на главной странице баннеры с актуальными акциями и распродажами, чтобы увеличить конверсию   
8                                                       Запустить акцию, дающую скидку на товар в день рождения   
3           Изменить структура категорий, что увеличит конверсию, т.к. пользователи быстрее найдут нужный товар   
1                                     Запустить собственную службу доставки, что сократит срок доставки заказов   
5                      Добавить страницу отзывов клиентов о магазине, что позволит увеличить количество заказов   
4                              Изменить цвет фона главной страницы, чтобы увеличить вовлеченность пользователей   

    RICE  
7  112.0  
2   56.0  
0   40.0  
6   40.0  
8   16.2  
3    9.0  
1    4.0  
5    4.0  
4    3.0  
```
Наиболее перспективные гипотезы по RICE:
- Добавить форму подписки на все основные страницы, чтобы собрать базу клиентов для email-рассылок
- Добавить блоки рекомендаций товаров на сайт интернет магазина, чтобы повысить конверсию и средний чек заказа
- Добавить два новых канала привлечения трафика, что позволит привлекать на 30% больше пользователей


**1.3  Укажите, как изменилась приоритизация гипотез при применении RICE вместо ICE. Объясните, почему так произошло.**
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
